{"ast":null,"code":"var _jsxFileName = \"/Users/nathan.schroeder/Documents/dev/ts-integration-demo/src/advanced_demo/ColumnList.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nimport React, { useState, useEffect, setState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction ColumnList(props) {\n  _s();\n\n  const {\n    worksheet,\n    updateSearch\n  } = props;\n  const [selectedColumns, setSelectedColumns] = useState('');\n  const [selectedFilters, setselectedFilters] = useState('');\n  const [chartFilter, setChartFilter] = useState('');\n\n  function toggleColumn(col) {\n    if (selectedColumns.includes(col)) {\n      setSelectedColumns(selectedColumns.filter(e => e !== col), updateSearch(selectedColumns, selectedFilters, chartFilter));\n    } else {\n      setSelectedColumns([...selectedColumns, col], updateSearch(selectedColumns, selectedFilters, chartFilter));\n    }\n  }\n\n  function toggleFilter(filter) {\n    console.log(filter, \"filter!!\");\n\n    if (selectedColumns.includes(filter)) {\n      setselectedFilters(selectedFilters.filter(e => e !== filter), updateSearch(selectedColumns, selectedFilters, chartFilter));\n    } else {\n      setselectedFilters([...selectedFilters, filter], updateSearch(selectedColumns, selectedFilters, chartFilter));\n    }\n  }\n\n  const [columns, setColumns] = useState('');\n  useEffect(() => {\n    updateSearch(selectedColumns, selectedFilters, chartFilter);\n  }, [selectedColumns]);\n  useEffect(() => {\n    updateSearch(selectedColumns, selectedFilters, chartFilter);\n  }, [selectedFilters]);\n  useEffect(() => {\n    window.addEventListener('chartFilter', function (e) {\n      setChartFilter(e.detail.name);\n      updateSearch(selectedColumns, selectedFilters, e.detail.name);\n    });\n    getWorksheet();\n  }, []);\n\n  function getWorksheet(restURLParams) {\n    let formData = 'export_ids=%5B' + worksheet + '%5D&formattype=JSON&export_associated=false';\n    let url = 'https://se-thoughtspot-cloud.thoughtspot.cloud/callosum/v1/tspublic/v1/metadata/tml/export';\n    fetch(url, {\n      headers: {\n        'Accept': 'text/plain',\n        'Content-Type': 'application/x-www-form-urlencoded'\n      },\n      method: 'POST',\n      credentials: 'include',\n      body: formData\n    }).then(response => response.text()).then(data => {\n      var fileinfo = JSON.parse(data);\n      var tml = JSON.parse(fileinfo.object[0].edoc);\n      setColumns(tml.worksheet.worksheet_columns);\n    });\n  }\n\n  var tables = {};\n\n  for (var col of columns) {\n    var table = col.column_id ? col.column_id.split(\"::\")[0] : 'FORMULAS';\n    tables[table] ? tables[table].push(col.name) : tables[table] = [col.name];\n  }\n\n  var menu = [];\n\n  for (var tableName of Object.keys(tables)) {\n    var colOptions = [];\n\n    for (var col of tables[tableName]) {\n      colOptions.push( /*#__PURE__*/_jsxDEV(Column, {\n        worksheet: worksheet,\n        col: col,\n        toggleColumn: toggleColumn,\n        toggleFilter: toggleFilter,\n        isSelected: selectedColumns && selectedColumns.includes(col)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 17\n      }, this));\n    }\n\n    menu.push( /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'flex-start',\n        minWidth: '200px',\n        maxWidth: 'calc(vw / 6)',\n        paddingLeft: '10px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontWeight: 600,\n          display: 'flex',\n          justifyContent: 'flex-start',\n          alignItems: 'center',\n          width: '100%',\n          height: '35px',\n          fontSize: '12px',\n          marginBottom: '5px'\n        },\n        children: tableName.replace(\"_1\", \"\").replace(\"_\", \" \")\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'flex-start',\n          overflow: 'auto',\n          scrollbarWidth: 'thin',\n          paddingLeft: '10px',\n          height: '90%'\n        },\n        children: colOptions\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 19\n    }, this));\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      height: '260px',\n      width: 'calc(100% - 40px)',\n      margin: '15px',\n      padding: '5px',\n      boxShadow: '0px 0px 15px #e6e6e6',\n      flexDirection: 'column',\n      display: 'flex'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        margin: '10px',\n        fontWeight: 600,\n        height: '25px'\n      },\n      children: \"Configuration\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginLeft: '10px',\n        marginRight: '10px',\n        width: 'calc(100% - 20px)',\n        display: 'flex',\n        flexDirection: 'row',\n        overflowX: 'auto'\n      },\n      children: menu\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 9\n  }, this);\n}\n\n_s(ColumnList, \"+Vl1Hj+v3/os2dzk3UC+ZidcKew=\");\n\n_c = ColumnList;\nexport default ColumnList;\n\nfunction Column(props) {\n  _s2();\n\n  const {\n    worksheet,\n    col,\n    isSelected,\n    toggleColumn,\n    toggleFilter\n  } = props;\n  const [filterListVisible, setFilterListVisible] = useState('');\n\n  function toggleColumnSelector() {\n    toggleColumn(col);\n  }\n\n  function toggleFilterSelection() {\n    setFilterListVisible(!filterListVisible);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"columnSelector\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      onClick: toggleColumnSelector,\n      style: {\n        marginRight: '5px',\n        width: '18px',\n        color: isSelected ? '#898989' : '#efefef',\n        display: 'flex',\n        alignItems: 'center'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"svg\", {\n        xmlns: \"http://www.w3.org/2000/svg\",\n        viewBox: \"-2 -1.5 24 24\",\n        width: \"18\",\n        fill: \"currentColor\",\n        children: /*#__PURE__*/_jsxDEV(\"path\", {\n          d: \"M4 .565h12a4 4 0 0 1 4 4v12a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4v-12a4 4 0 0 1 4-4z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 108\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      onClick: toggleFilterSelection,\n      style: {\n        marginRight: '5px',\n        width: '18px',\n        color: '#cccccccc',\n        display: 'flex',\n        alignItems: 'center'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"svg\", {\n        xmlns: \"http://www.w3.org/2000/svg\",\n        viewBox: \"-3 -2.5 24 24\",\n        width: \"18\",\n        fill: \"currentColor\",\n        children: /*#__PURE__*/_jsxDEV(\"path\", {\n          d: \"M1.08.858h15.84a1 1 0 0 1 .78 1.625l-6.48 8.101a1 1 0 0 0-.22.625v5.149a1 1 0 0 1-.4.8l-2 1.5a1 1 0 0 1-1.6-.8v-6.65a1 1 0 0 0-.22-.624L.3 2.483A1 1 0 0 1 1.08.858z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 108\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        alignItems: 'center'\n      },\n      children: [\" \", col]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 13\n    }, this), filterListVisible ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: toggleFilterSelection,\n        style: {\n          zIndex: 998,\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          width: '100vh',\n          height: '100vh'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(FilterPopup, {\n        worksheet: worksheet,\n        col: col,\n        toggleFilter: toggleFilter\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 17\n    }, this) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 112,\n    columnNumber: 9\n  }, this);\n}\n\n_s2(Column, \"gzvS8E9p4pU/HAkpHMOl9f8Pq+k=\");\n\n_c2 = Column;\n\nfunction FilterPopup(props) {\n  _s3();\n\n  const {\n    worksheet,\n    col,\n    toggleFilter\n  } = props;\n  const [filterValues, setFilterValues] = useState('');\n  useEffect(() => {\n    var queryString = '[' + col + ']';\n\n    if (queryString) {\n      var url = \"https://se-thoughtspot-cloud.thoughtspot.cloud/callosum/v1/tspublic/v1/searchdata?query_string=\" + encodeURIComponent(queryString) + \"&data_source_guid=\" + worksheet + \"&batchsize=-1&pagenumber=-1&offset=-1&formattype=COMPACT\";\n      fetch(url, {\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        },\n        method: 'POST',\n        credentials: 'include'\n      }).then(response => response.json()).then(data => {\n        setFilterValues(data.data);\n      });\n    }\n  }, []);\n  var filterOptions = [];\n\n  for (var i = 0; i < filterValues.length; i++) {\n    var val = filterValues[i][0];\n    filterOptions.push( /*#__PURE__*/_jsxDEV(Filter, {\n      value: val,\n      toggleFilter: toggleFilter\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 28\n    }, this));\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      boxShadow: '0px 0px 25px #e0e0e0',\n      zIndex: 999,\n      display: 'flex',\n      flexDirection: 'column',\n      position: 'absolute',\n      background: '#ffffff',\n      padding: '10px'\n    },\n    children: filterOptions\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 167,\n    columnNumber: 9\n  }, this);\n}\n\n_s3(FilterPopup, \"v2pgna9sKEmQjcDrEAKuLXJg5m4=\");\n\n_c3 = FilterPopup;\n\nfunction Filter(props) {\n  const {\n    value,\n    toggleFilter\n  } = props;\n\n  function toggleFilterValue() {\n    toggleFilter(value);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"filterPicker\",\n    onClick: toggleFilterValue,\n    style: {\n      height: '20px',\n      padding: '5px',\n      marginBottom: '5px',\n      display: 'flex',\n      alignItems: 'flex-start'\n    },\n    children: value\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 183,\n    columnNumber: 9\n  }, this);\n}\n\n_c4 = Filter;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"ColumnList\");\n$RefreshReg$(_c2, \"Column\");\n$RefreshReg$(_c3, \"FilterPopup\");\n$RefreshReg$(_c4, \"Filter\");","map":{"version":3,"sources":["/Users/nathan.schroeder/Documents/dev/ts-integration-demo/src/advanced_demo/ColumnList.js"],"names":["React","useState","useEffect","setState","ColumnList","props","worksheet","updateSearch","selectedColumns","setSelectedColumns","selectedFilters","setselectedFilters","chartFilter","setChartFilter","toggleColumn","col","includes","filter","e","toggleFilter","console","log","columns","setColumns","window","addEventListener","detail","name","getWorksheet","restURLParams","formData","url","fetch","headers","method","credentials","body","then","response","text","data","fileinfo","JSON","parse","tml","object","edoc","worksheet_columns","tables","table","column_id","split","push","menu","tableName","Object","keys","colOptions","display","flexDirection","alignItems","minWidth","maxWidth","paddingLeft","fontWeight","justifyContent","width","height","fontSize","marginBottom","replace","overflow","scrollbarWidth","margin","padding","boxShadow","marginLeft","marginRight","overflowX","Column","isSelected","filterListVisible","setFilterListVisible","toggleColumnSelector","toggleFilterSelection","color","zIndex","position","top","left","FilterPopup","filterValues","setFilterValues","queryString","encodeURIComponent","json","filterOptions","i","length","val","background","Filter","value","toggleFilterValue"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, setState } from 'react';\nfunction ColumnList(props){\n    const {\n        worksheet,\n        updateSearch,\n    } = props\n    const [selectedColumns, setSelectedColumns] = useState('')\n    const [selectedFilters, setselectedFilters] = useState('')\n    const [chartFilter, setChartFilter] = useState('')\n\n    function toggleColumn(col){\n        if (selectedColumns.includes(col)){\n            setSelectedColumns(selectedColumns.filter((e)=>(e !== col)),updateSearch(selectedColumns,selectedFilters,chartFilter))\n        }else{\n            setSelectedColumns([...selectedColumns, col], updateSearch(selectedColumns,selectedFilters,chartFilter))\n        }\n        \n    }\n    function toggleFilter(filter){\n        console.log(filter,\"filter!!\")\n        if (selectedColumns.includes(filter)){\n            setselectedFilters(selectedFilters.filter((e)=>(e !== filter)),updateSearch(selectedColumns,selectedFilters,chartFilter))\n        }else{\n            setselectedFilters([...selectedFilters, filter], updateSearch(selectedColumns,selectedFilters,chartFilter))\n        }\n    }\n    const [columns,setColumns] = useState('')\n    useEffect(() => {\n        updateSearch(selectedColumns,selectedFilters,chartFilter)\n    }, [selectedColumns]);\n    useEffect(() => {\n        updateSearch(selectedColumns,selectedFilters,chartFilter)\n    }, [selectedFilters]);\n    useEffect(() => {\n        window.addEventListener('chartFilter', function(e){\n            setChartFilter(e.detail.name)\n            updateSearch(selectedColumns,selectedFilters,e.detail.name)\n        })\n        getWorksheet()\n    }, [])\n    function getWorksheet(restURLParams){\n        let formData = 'export_ids=%5B'+worksheet+'%5D&formattype=JSON&export_associated=false'\n        let url = 'https://se-thoughtspot-cloud.thoughtspot.cloud/callosum/v1/tspublic/v1/metadata/tml/export'\n        fetch(url,\n        {\n          headers: {\n            'Accept': 'text/plain',\n            'Content-Type': 'application/x-www-form-urlencoded'\n          },\n          method:'POST',\n          credentials: 'include',\n          body: formData\n        })\n        .then(response => response.text()).then(\n          data => {\n              var fileinfo = JSON.parse(data)\n              var tml = JSON.parse(fileinfo.object[0].edoc)\n              setColumns(tml.worksheet.worksheet_columns)\n        })\n      }\n      var tables = {}\n      for (var col of columns){\n        var table = col.column_id ? col.column_id.split(\"::\")[0] : 'FORMULAS'\n        tables[table] ? tables[table].push(col.name) : tables[table] = [col.name]\n      }\n\n      var menu = []\n      for (var tableName of Object.keys(tables)){\n        var colOptions = []\n        for (var col of tables[tableName]){\n            colOptions.push(\n                <Column worksheet={worksheet} col={col} toggleColumn={toggleColumn} toggleFilter={toggleFilter} isSelected={selectedColumns && selectedColumns.includes(col)}></Column>\n            )\n        }\n        menu.push(<div style={{display:'flex',flexDirection:'column',alignItems:'flex-start',minWidth:'200px',maxWidth:'calc(vw / 6)',paddingLeft:'10px'}}>\n            <div style={{fontWeight:600,display:'flex',justifyContent:'flex-start',alignItems:'center',width:'100%',height:'35px',fontSize:'12px',marginBottom:'5px'}}>\n                {tableName.replace(\"_1\",\"\").replace(\"_\",\" \")}\n            </div>\n            <div style={{display:'flex',flexDirection:'column',alignItems:'flex-start',overflow:'auto',scrollbarWidth:'thin',paddingLeft:'10px',height:'90%'}}>\n            {colOptions}\n            </div>\n            </div>)\n      }\n      return (\n        <div style={{height:'260px',width:'calc(100% - 40px)',margin:'15px',padding:'5px',boxShadow:'0px 0px 15px #e6e6e6',flexDirection:'column',display:'flex'}}>\n                <div style={{margin:'10px',fontWeight:600,height:'25px'}}>Configuration</div>\n                <div style={{marginLeft:'10px',marginRight:'10px',width:'calc(100% - 20px)',display:'flex',flexDirection:'row',overflowX:'auto'}}>\n                    {menu}\n                </div>\n        </div>\n\n      )\n}\nexport default ColumnList\n\nfunction Column(props){\n    const {\n        worksheet,\n        col,\n        isSelected,\n        toggleColumn,\n        toggleFilter\n    } = props\n    const [filterListVisible, setFilterListVisible] = useState('')\n    function toggleColumnSelector(){\n        toggleColumn(col)\n    }\n    function toggleFilterSelection(){\n        setFilterListVisible(!filterListVisible)\n    }\n    return(\n        <div className=\"columnSelector\" >\n            <div  onClick={toggleColumnSelector} style={{marginRight:'5px', width:'18px',color:isSelected?'#898989':'#efefef',display:'flex',alignItems:'center'}}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"-2 -1.5 24 24\" width=\"18\" fill=\"currentColor\"><path d=\"M4 .565h12a4 4 0 0 1 4 4v12a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4v-12a4 4 0 0 1 4-4z\"></path></svg>\n            </div>\n            <div  onClick={toggleFilterSelection} style={{marginRight:'5px', width:'18px',color:'#cccccccc',display:'flex',alignItems:'center'}}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"-3 -2.5 24 24\" width=\"18\" fill=\"currentColor\"><path d=\"M1.08.858h15.84a1 1 0 0 1 .78 1.625l-6.48 8.101a1 1 0 0 0-.22.625v5.149a1 1 0 0 1-.4.8l-2 1.5a1 1 0 0 1-1.6-.8v-6.65a1 1 0 0 0-.22-.624L.3 2.483A1 1 0 0 1 1.08.858z\"></path></svg>\n            </div>\n            <div style={{display:'flex',alignItems:'center'}}> {col}</div>\n            {filterListVisible?\n                <div>\n                    <div onClick={toggleFilterSelection} style={{zIndex:998,position:'fixed',top:0,left:0,width:'100vh',height:'100vh'}}>\n                    </div>\n                    <FilterPopup worksheet={worksheet} col={col} toggleFilter={toggleFilter}></FilterPopup>\n                </div>\n            :null}\n        </div>\n        \n    )\n}\n\nfunction FilterPopup(props){\n    const {\n        worksheet,\n        col,\n        toggleFilter\n    } = props\n    \n    const [filterValues, setFilterValues] = useState('')\n\n    useEffect(() => {\n        var queryString = '['+col+']'\n        if (queryString){\n            var url = \"https://se-thoughtspot-cloud.thoughtspot.cloud/callosum/v1/tspublic/v1/searchdata?query_string=\"+encodeURIComponent(queryString)+\n            \"&data_source_guid=\"+worksheet+\"&batchsize=-1&pagenumber=-1&offset=-1&formattype=COMPACT\"\n            fetch(url,\n            {\n                headers: {\n                'Accept': 'application/json',\n                'Content-Type': 'application/json'\n                },\n                method:'POST',\n                credentials: 'include',\n            })\n            .then(response => response.json()).then(\n                data => {\n                    setFilterValues(data.data)\n            })\n        }\n    },[])\n    var filterOptions = []\n    for (var i=0;i<filterValues.length;i++){\n        var val = filterValues[i][0];\n        filterOptions.push(<Filter value={val} toggleFilter={toggleFilter}></Filter>)\n    }\n    return(\n        <div style={{boxShadow:'0px 0px 25px #e0e0e0', zIndex:999,display:'flex',flexDirection:'column',position:'absolute',background:'#ffffff',padding:'10px'}}>\n            {filterOptions}\n        </div>\n\n\n    )\n}\nfunction Filter(props){\n    const {\n        value,\n        toggleFilter\n    } = props\n    function toggleFilterValue(){\n        toggleFilter(value)\n    }\n    return (\n        <div className=\"filterPicker\" \n            onClick={toggleFilterValue}\n            style={{height:'20px',\n            padding:'5px',\n            marginBottom:'5px',\n            display:'flex',\n            alignItems:'flex-start'}}>\n            {value}\n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}