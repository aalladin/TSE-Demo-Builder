{"ast":null,"code":"var _jsxFileName = \"/Users/nathan.schroeder/Documents/dev/ts-integration-demo/src/ColumnList.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nimport React, { useState, useEffect, setState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction ColumnList(props) {\n  _s();\n\n  const {\n    worksheet,\n    updateSearch\n  } = props;\n  const [selectedColumns, setSelectedColumns] = useState('');\n  const [selectedFilters, setselectedFilters] = useState('');\n  const [chartFilter, setChartFilter] = useState('');\n\n  function toggleColumn(col) {\n    if (selectedColumns.includes(col)) {\n      setSelectedColumns(selectedColumns.filter(e => e !== col), updateSearch(selectedColumns, selectedFilters, chartFilter));\n    } else {\n      setSelectedColumns([...selectedColumns, col], updateSearch(selectedColumns, selectedFilters, chartFilter));\n    }\n  }\n\n  function toggleFilter(filter) {\n    console.log(filter, \"filter!!\");\n\n    if (selectedColumns.includes(filter)) {\n      setselectedFilters(selectedFilters.filter(e => e !== filter), updateSearch(selectedColumns, selectedFilters, chartFilter));\n    } else {\n      setselectedFilters([...selectedFilters, filter], updateSearch(selectedColumns, selectedFilters, chartFilter));\n    }\n  }\n\n  const [columns, setColumns] = useState('');\n  useEffect(() => {\n    updateSearch(selectedColumns, selectedFilters, chartFilter);\n  }, [selectedColumns]);\n  useEffect(() => {\n    updateSearch(selectedColumns, selectedFilters, chartFilter);\n  }, [selectedFilters]);\n  useEffect(() => {\n    window.addEventListener('chartFilter', function (e) {\n      setChartFilter(e.detail.name);\n      updateSearch(selectedColumns, selectedFilters, e.detail.name);\n    });\n    getWorksheet();\n  }, []);\n\n  function getWorksheet(restURLParams) {\n    let formData = 'export_ids=%5B' + worksheet + '%5D&formattype=JSON&export_associated=false';\n    let url = 'https://se-thoughtspot-cloud.thoughtspot.cloud/callosum/v1/tspublic/v1/metadata/tml/export';\n    fetch(url, {\n      headers: {\n        'Accept': 'text/plain',\n        'Content-Type': 'application/x-www-form-urlencoded'\n      },\n      method: 'POST',\n      credentials: 'include',\n      body: formData\n    }).then(response => response.text()).then(data => {\n      var fileinfo = JSON.parse(data);\n      var tml = JSON.parse(fileinfo.object[0].edoc);\n      setColumns(tml.worksheet.worksheet_columns);\n    });\n  }\n\n  var tables = {};\n\n  for (var col of columns) {\n    var table = col.column_id ? col.column_id.split(\"::\")[0] : 'FORMULAS';\n    tables[table] ? tables[table].push(col.name) : tables[table] = [col.name];\n  }\n\n  var menu = [];\n\n  for (var tableName of Object.keys(tables)) {\n    var colOptions = [];\n\n    for (var col of tables[tableName]) {\n      colOptions.push( /*#__PURE__*/_jsxDEV(Column, {\n        worksheet: worksheet,\n        col: col,\n        toggleColumn: toggleColumn,\n        toggleFilter: toggleFilter,\n        isSelected: selectedColumns && selectedColumns.includes(col)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 17\n      }, this));\n    }\n\n    menu.push( /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'flex-start',\n        height: '150px',\n        padding: '10px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontWeight: 600,\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          width: '100%',\n          marginBottom: '5px'\n        },\n        children: tableName.replace(\"_1\", \"\").replace(\"_\", \" \")\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          width: '150px',\n          flexDirection: 'column',\n          alignItems: 'flex-start',\n          overflow: 'auto',\n          scrollbarWidth: 'thin'\n        },\n        children: colOptions\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 19\n    }, this));\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      boxShadow: '0px 0px 15px #e6e6e6',\n      padding: '10px',\n      marginLeft: '15px',\n      marginRight: '15px',\n      marginTop: '15px',\n      flexDirection: 'row'\n    },\n    children: menu\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 9\n  }, this);\n}\n\n_s(ColumnList, \"+Vl1Hj+v3/os2dzk3UC+ZidcKew=\");\n\n_c = ColumnList;\nexport default ColumnList;\n\nfunction Column(props) {\n  _s2();\n\n  const {\n    worksheet,\n    col,\n    isSelected,\n    toggleColumn,\n    toggleFilter\n  } = props;\n  const [filterListVisible, setFilterListVisible] = useState('');\n\n  function toggleColumnSelector() {\n    toggleColumn(col);\n  }\n\n  function toggleFilterSelection() {\n    setFilterListVisible(!filterListVisible);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      fontSize: '11px',\n      wordWrap: 'none',\n      display: 'flex',\n      flexDirection: 'row',\n      minHeight: '25px',\n      borderBottom: '1px solid #efefef',\n      alignItems: 'center'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      onClick: toggleColumnSelector,\n      style: {\n        marginRight: '5px',\n        minHeight: '15px',\n        width: '15px',\n        borderRadius: '5px',\n        background: isSelected ? '#276fef' : '#efefef'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      onClick: toggleFilterSelection,\n      style: {\n        marginRight: '5px',\n        minHeight: '15px',\n        width: '15px',\n        borderRadius: '5px',\n        border: '1px solid #cccccc'\n      },\n      children: \"f\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\" \", col]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 9\n    }, this), filterListVisible ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: toggleFilterSelection,\n        style: {\n          zIndex: 998,\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          width: '100vh',\n          height: '100vh'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(FilterPopup, {\n        worksheet: worksheet,\n        col: col,\n        toggleFilter: toggleFilter\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }, this) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 108,\n    columnNumber: 9\n  }, this);\n}\n\n_s2(Column, \"gzvS8E9p4pU/HAkpHMOl9f8Pq+k=\");\n\n_c2 = Column;\n\nfunction FilterPopup(props) {\n  _s3();\n\n  const {\n    worksheet,\n    col,\n    toggleFilter\n  } = props;\n  const [filterValues, setFilterValues] = useState('');\n  useEffect(() => {\n    var queryString = '[' + col + ']';\n\n    if (queryString) {\n      var url = \"https://se-thoughtspot-cloud.thoughtspot.cloud/callosum/v1/tspublic/v1/searchdata?query_string=\" + encodeURIComponent(queryString) + \"&data_source_guid=\" + worksheet + \"&batchsize=-1&pagenumber=-1&offset=-1&formattype=COMPACT\";\n      fetch(url, {\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        },\n        method: 'POST',\n        credentials: 'include'\n      }).then(response => response.json()).then(data => {\n        setFilterValues(data.data);\n      });\n    }\n  }, []);\n  var filterOptions = [];\n\n  for (var i = 0; i < filterValues.length; i++) {\n    var val = filterValues[i][0];\n    filterOptions.push( /*#__PURE__*/_jsxDEV(Filter, {\n      value: val,\n      toggleFilter: toggleFilter\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 28\n    }, this));\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      boxShadow: '0px 0px 25px #e0e0e0',\n      zIndex: 999,\n      display: 'flex',\n      flexDirection: 'column',\n      position: 'absolute',\n      background: '#ffffff',\n      padding: '10px'\n    },\n    children: filterOptions\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 161,\n    columnNumber: 9\n  }, this);\n}\n\n_s3(FilterPopup, \"v2pgna9sKEmQjcDrEAKuLXJg5m4=\");\n\n_c3 = FilterPopup;\n\nfunction Filter(props) {\n  const {\n    value,\n    toggleFilter\n  } = props;\n\n  function toggleFilterValue() {\n    toggleFilter(value);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"filterPicker\",\n    onClick: toggleFilterValue,\n    style: {\n      height: '20px',\n      padding: '5px',\n      marginBottom: '5px',\n      display: 'flex',\n      alignItems: 'flex-start'\n    },\n    children: value\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 177,\n    columnNumber: 9\n  }, this);\n}\n\n_c4 = Filter;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"ColumnList\");\n$RefreshReg$(_c2, \"Column\");\n$RefreshReg$(_c3, \"FilterPopup\");\n$RefreshReg$(_c4, \"Filter\");","map":{"version":3,"sources":["/Users/nathan.schroeder/Documents/dev/ts-integration-demo/src/ColumnList.js"],"names":["React","useState","useEffect","setState","ColumnList","props","worksheet","updateSearch","selectedColumns","setSelectedColumns","selectedFilters","setselectedFilters","chartFilter","setChartFilter","toggleColumn","col","includes","filter","e","toggleFilter","console","log","columns","setColumns","window","addEventListener","detail","name","getWorksheet","restURLParams","formData","url","fetch","headers","method","credentials","body","then","response","text","data","fileinfo","JSON","parse","tml","object","edoc","worksheet_columns","tables","table","column_id","split","push","menu","tableName","Object","keys","colOptions","display","flexDirection","alignItems","height","padding","fontWeight","justifyContent","width","marginBottom","replace","overflow","scrollbarWidth","boxShadow","marginLeft","marginRight","marginTop","Column","isSelected","filterListVisible","setFilterListVisible","toggleColumnSelector","toggleFilterSelection","fontSize","wordWrap","minHeight","borderBottom","borderRadius","background","border","zIndex","position","top","left","FilterPopup","filterValues","setFilterValues","queryString","encodeURIComponent","json","filterOptions","i","length","val","Filter","value","toggleFilterValue"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, setState } from 'react';\nfunction ColumnList(props){\n    const {\n        worksheet,\n        updateSearch,\n    } = props\n    const [selectedColumns, setSelectedColumns] = useState('')\n    const [selectedFilters, setselectedFilters] = useState('')\n    const [chartFilter, setChartFilter] = useState('')\n\n    function toggleColumn(col){\n        if (selectedColumns.includes(col)){\n            setSelectedColumns(selectedColumns.filter((e)=>(e !== col)),updateSearch(selectedColumns,selectedFilters,chartFilter))\n        }else{\n            setSelectedColumns([...selectedColumns, col], updateSearch(selectedColumns,selectedFilters,chartFilter))\n        }\n        \n    }\n    function toggleFilter(filter){\n        console.log(filter,\"filter!!\")\n        if (selectedColumns.includes(filter)){\n            setselectedFilters(selectedFilters.filter((e)=>(e !== filter)),updateSearch(selectedColumns,selectedFilters,chartFilter))\n        }else{\n            setselectedFilters([...selectedFilters, filter], updateSearch(selectedColumns,selectedFilters,chartFilter))\n        }\n    }\n    const [columns,setColumns] = useState('')\n    useEffect(() => {\n        updateSearch(selectedColumns,selectedFilters,chartFilter)\n    }, [selectedColumns]);\n    useEffect(() => {\n        updateSearch(selectedColumns,selectedFilters,chartFilter)\n    }, [selectedFilters]);\n    useEffect(() => {\n        window.addEventListener('chartFilter', function(e){\n            setChartFilter(e.detail.name)\n            updateSearch(selectedColumns,selectedFilters,e.detail.name)\n        })\n        getWorksheet()\n    }, [])\n    function getWorksheet(restURLParams){\n        let formData = 'export_ids=%5B'+worksheet+'%5D&formattype=JSON&export_associated=false'\n        let url = 'https://se-thoughtspot-cloud.thoughtspot.cloud/callosum/v1/tspublic/v1/metadata/tml/export'\n        fetch(url,\n        {\n          headers: {\n            'Accept': 'text/plain',\n            'Content-Type': 'application/x-www-form-urlencoded'\n          },\n          method:'POST',\n          credentials: 'include',\n          body: formData\n        })\n        .then(response => response.text()).then(\n          data => {\n              var fileinfo = JSON.parse(data)\n              var tml = JSON.parse(fileinfo.object[0].edoc)\n              setColumns(tml.worksheet.worksheet_columns)\n        })\n      }\n      var tables = {}\n      for (var col of columns){\n        var table = col.column_id ? col.column_id.split(\"::\")[0] : 'FORMULAS'\n        tables[table] ? tables[table].push(col.name) : tables[table] = [col.name]\n      }\n\n      var menu = []\n      for (var tableName of Object.keys(tables)){\n        var colOptions = []\n        for (var col of tables[tableName]){\n            colOptions.push(\n                <Column worksheet={worksheet} col={col} toggleColumn={toggleColumn} toggleFilter={toggleFilter} isSelected={selectedColumns && selectedColumns.includes(col)}></Column>\n            )\n        }\n        menu.push(<div style={{display:'flex',flexDirection:'column',alignItems:'flex-start', height:'150px',padding:'10px'}}>\n            <div style={{fontWeight:600,display:'flex',justifyContent:'center',alignItems:'center',width:'100%',marginBottom:'5px'}}>\n                {tableName.replace(\"_1\",\"\").replace(\"_\",\" \")}\n            </div>\n            <div style={{display:'flex',width:'150px',flexDirection:'column',alignItems:'flex-start',overflow:'auto',scrollbarWidth:'thin'}}>\n            {colOptions}\n            </div>\n            </div>)\n      }\n      return (\n        <div style={{display:'flex',boxShadow:'0px 0px 15px #e6e6e6',padding:'10px',marginLeft:'15px',marginRight:'15px',marginTop:'15px',flexDirection:'row'}}>\n            {menu}\n        </div>\n      )\n}\nexport default ColumnList\n\nfunction Column(props){\n    const {\n        worksheet,\n        col,\n        isSelected,\n        toggleColumn,\n        toggleFilter\n    } = props\n    const [filterListVisible, setFilterListVisible] = useState('')\n    function toggleColumnSelector(){\n        toggleColumn(col)\n    }\n    function toggleFilterSelection(){\n        setFilterListVisible(!filterListVisible)\n    }\n    return(\n        <div style={{fontSize:'11px', wordWrap:'none',display:'flex',flexDirection:'row',minHeight:'25px',borderBottom:'1px solid #efefef',alignItems:'center'}} >\n        <div  onClick={toggleColumnSelector} style={{marginRight:'5px',minHeight:'15px',width:'15px',borderRadius:'5px',background:isSelected?'#276fef':'#efefef'}}>\n        </div>\n        <div  onClick={toggleFilterSelection} style={{marginRight:'5px',minHeight:'15px',width:'15px',borderRadius:'5px',border:'1px solid #cccccc'}}>\n        f</div>\n        <div> {col}</div>\n        {filterListVisible?\n            <div>\n                <div onClick={toggleFilterSelection} style={{zIndex:998,position:'fixed',top:0,left:0,width:'100vh',height:'100vh'}}>\n                </div>\n                <FilterPopup worksheet={worksheet} col={col} toggleFilter={toggleFilter}></FilterPopup>\n            </div>\n        :null}\n        </div>\n        \n    )\n}\n\nfunction FilterPopup(props){\n    const {\n        worksheet,\n        col,\n        toggleFilter\n    } = props\n    \n    const [filterValues, setFilterValues] = useState('')\n\n    useEffect(() => {\n        var queryString = '['+col+']'\n        if (queryString){\n            var url = \"https://se-thoughtspot-cloud.thoughtspot.cloud/callosum/v1/tspublic/v1/searchdata?query_string=\"+encodeURIComponent(queryString)+\n            \"&data_source_guid=\"+worksheet+\"&batchsize=-1&pagenumber=-1&offset=-1&formattype=COMPACT\"\n            fetch(url,\n            {\n                headers: {\n                'Accept': 'application/json',\n                'Content-Type': 'application/json'\n                },\n                method:'POST',\n                credentials: 'include',\n            })\n            .then(response => response.json()).then(\n                data => {\n                    setFilterValues(data.data)\n            })\n        }\n    },[])\n    var filterOptions = []\n    for (var i=0;i<filterValues.length;i++){\n        var val = filterValues[i][0];\n        filterOptions.push(<Filter value={val} toggleFilter={toggleFilter}></Filter>)\n    }\n    return(\n        <div style={{boxShadow:'0px 0px 25px #e0e0e0', zIndex:999,display:'flex',flexDirection:'column',position:'absolute',background:'#ffffff',padding:'10px'}}>\n            {filterOptions}\n        </div>\n\n\n    )\n}\nfunction Filter(props){\n    const {\n        value,\n        toggleFilter\n    } = props\n    function toggleFilterValue(){\n        toggleFilter(value)\n    }\n    return (\n        <div className=\"filterPicker\" \n            onClick={toggleFilterValue}\n            style={{height:'20px',\n            padding:'5px',\n            marginBottom:'5px',\n            display:'flex',\n            alignItems:'flex-start'}}>\n            {value}\n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}