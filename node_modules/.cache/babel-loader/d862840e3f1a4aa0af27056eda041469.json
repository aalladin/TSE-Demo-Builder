{"ast":null,"code":"var _jsxFileName = \"/Users/nathan.schroeder/Documents/dev/ts-integration-demo/src/D3Chart.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect, useRef } from \"react\";\nimport * as d3 from \"d3\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction D3Chart(props) {\n  _s();\n\n  const {\n    data\n  } = props;\n  const svg = useRef(null);\n  useEffect(() => {\n    if (data && data[0].length > 2) {\n      var packedData = convertToCirclePack(data);\n      var svgData = chart({\n        'name': 'charty',\n        'children': packedData\n      });\n      svgData.setAttribute(\"height\", 600);\n      svgData.setAttribute(\"width\", 600);\n\n      if (svg.current) {\n        svg.current.innerHTML = \"\";\n        svg.current.appendChild(svgData);\n      }\n    }\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: svg\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 25,\n    columnNumber: 9\n  }, this);\n}\n\n_s(D3Chart, \"P4QkRe0k/YAmf3z9I+VDqWHPsEE=\");\n\n_c = D3Chart;\nexport default D3Chart;\n\nfunction chart(data) {\n  var height = 600;\n  var width = 600;\n  var format = d3.format(\",d\");\n  var color = d3.scaleLinear().domain([0, 5]).range([\"hsl(152,80%,80%)\", \"hsl(228,30%,40%)\"]).interpolate(d3.interpolateHcl);\n  const root = d3.pack().size([width, height]).padding(3)(d3.hierarchy(data).sum(d => d.value).sort((a, b) => b.value - a.value));\n  let focus = root;\n  let view;\n  const svg = d3.create(\"svg\").attr(\"viewBox\", `-${width / 2} -${height / 2} ${width} ${height}`).style(\"display\", \"block\").style(\"margin\", \"0 -14px\").style(\"background\", color(0)).style(\"cursor\", \"pointer\").on(\"click\", handleResetClick);\n  const node = svg.append(\"g\").selectAll(\"circle\").data(root.descendants().slice(1)).join(\"circle\").attr(\"fill\", d => d.children ? color(d.depth) : \"white\").attr(\"pointer-events\", d => !d.children ? \"none\" : null).on(\"mouseover\", function () {\n    d3.select(this).attr(\"stroke\", \"#000\");\n  }).on(\"mouseout\", function () {\n    d3.select(this).attr(\"stroke\", null);\n  }).on(\"click\", handleClick);\n  const label = svg.append(\"g\").style(\"font\", \"10px sans-serif\").attr(\"pointer-events\", \"none\").attr(\"text-anchor\", \"middle\").selectAll(\"text\").data(root.descendants()).join(\"text\").style(\"fill-opacity\", d => d.parent === root ? 1 : 0).style(\"display\", d => d.parent === root ? \"inline\" : \"none\").text(d => d.data.name);\n  zoomTo([root.x, root.y, root.r * 2]);\n\n  function handleClick(event, d) {\n    console.log(\"clicky!!!!\", event, d);\n    var ev = new CustomEvent('chartFilter', {\n      detail: {\n        'name': d.data.name,\n        'depth': d.depth\n      }\n    });\n    window.dispatchEvent(ev);\n    return focus !== d && (zoom(event, d), event.stopPropagation());\n  }\n\n  function handleResetClick(event) {\n    zoom(event, root);\n    var ev = new CustomEvent('chartFilter', {\n      detail: {\n        'name': '',\n        'depth': 0\n      }\n    });\n    window.dispatchEvent(ev);\n  }\n\n  function zoomTo(v) {\n    const k = width / v[2];\n    view = v;\n    label.attr(\"transform\", d => `translate(${(d.x - v[0]) * k},${(d.y - v[1]) * k})`);\n    node.attr(\"transform\", d => `translate(${(d.x - v[0]) * k},${(d.y - v[1]) * k})`);\n    node.attr(\"r\", d => d.r * k);\n  }\n\n  function zoom(event, d) {\n    const focus0 = focus;\n    focus = d;\n    const transition = svg.transition().duration(event.altKey ? 7500 : 750).tween(\"zoom\", d => {\n      const i = d3.interpolateZoom(view, [focus.x, focus.y, focus.r * 2]);\n      return t => zoomTo(i(t));\n    });\n    label.filter(function (d) {\n      return d.parent === focus || this.style.display === \"inline\";\n    }).transition(transition).style(\"fill-opacity\", d => d.parent === focus ? 1 : 0).on(\"start\", function (d) {\n      if (d.parent === focus) this.style.display = \"inline\";\n    }).on(\"end\", function (d) {\n      if (d.parent !== focus) this.style.display = \"none\";\n    });\n  }\n\n  return svg.node();\n}\n\nfunction convertToCirclePack(data) {\n  //find first numeric column\n  var outObj = [];\n\n  for (var i = 0; i < data.length; i++) {\n    var row = data[i];\n\n    for (var j = 1; j < row.length; j++) {\n      outObj = addChild(outObj, row, 0);\n    }\n  }\n\n  console.log(\"out obj\", outObj);\n  return outObj;\n}\n\nfunction addChild(currentObj, row, iteration) {\n  var idx = currentObj.findIndex(x => x.name === row[iteration]);\n\n  if (idx != -1 && currentObj[idx].children) {\n    var nextObj = currentObj[idx].children;\n\n    if (iteration == row.length) {\n      currentObj[idx]['value'] = row[iteration];\n      return currentObj;\n    } else {\n      currentObj[idx].children = addChild(nextObj, row, iteration + 1);\n    }\n  } else {\n    if (iteration == row.length - 2) {\n      currentObj[currentObj.length] = {\n        'name': row[iteration],\n        'value': row[iteration + 1]\n      };\n    } else {\n      currentObj[currentObj.length] = {\n        'name': row[iteration],\n        'children': addChild([], row, iteration + 1)\n      };\n    }\n  }\n\n  return currentObj;\n}\n\nvar _c;\n\n$RefreshReg$(_c, \"D3Chart\");","map":{"version":3,"sources":["/Users/nathan.schroeder/Documents/dev/ts-integration-demo/src/D3Chart.js"],"names":["useState","useEffect","useRef","d3","D3Chart","props","data","svg","length","packedData","convertToCirclePack","svgData","chart","setAttribute","current","innerHTML","appendChild","height","width","format","color","scaleLinear","domain","range","interpolate","interpolateHcl","root","pack","size","padding","hierarchy","sum","d","value","sort","a","b","focus","view","create","attr","style","on","handleResetClick","node","append","selectAll","descendants","slice","join","children","depth","select","handleClick","label","parent","text","name","zoomTo","x","y","r","event","console","log","ev","CustomEvent","detail","window","dispatchEvent","zoom","stopPropagation","v","k","focus0","transition","duration","altKey","tween","i","interpolateZoom","t","filter","display","outObj","row","j","addChild","currentObj","iteration","idx","findIndex","nextObj"],"mappings":"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","sourcesContent":["import { useState,useEffect,useRef } from \"react\";\nimport * as d3 from \"d3\"\n\nfunction D3Chart(props){\n    const {\n        data\n    } = props\n    const svg = useRef(null);\n\n    useEffect(()=>{\n        if (data && data[0].length > 2){\n            var packedData = convertToCirclePack(data)\n            var svgData = chart({'name':'charty','children':packedData})\n            svgData.setAttribute(\"height\",600)\n            svgData.setAttribute(\"width\",600)\n            if(svg.current){\n                svg.current.innerHTML = \"\"\n                svg.current.appendChild(svgData)\n            } \n        }\n    });\n\n\n    return (\n        <div ref={svg}/>\n    )\n}\nexport default D3Chart\nfunction chart(data){\n    var height = 600\n    var width = 600\n    var format = d3.format(\",d\")\n    var color = d3.scaleLinear()\n    .domain([0, 5])\n    .range([\"hsl(152,80%,80%)\", \"hsl(228,30%,40%)\"])\n    .interpolate(d3.interpolateHcl)\n    const root = d3.pack()\n            .size([width, height])\n            .padding(3)\n        (d3.hierarchy(data)\n            .sum(d => d.value)\n            .sort((a, b) => b.value - a.value))\n    let focus = root;\n    let view;\n  \n    const svg = d3.create(\"svg\")\n        .attr(\"viewBox\", `-${width / 2} -${height / 2} ${width} ${height}`)\n        .style(\"display\", \"block\")\n        .style(\"margin\", \"0 -14px\")\n        .style(\"background\", color(0))\n        .style(\"cursor\", \"pointer\")\n        .on(\"click\", handleResetClick);\n  \n    const node = svg.append(\"g\")\n      .selectAll(\"circle\")\n      .data(root.descendants().slice(1))\n      .join(\"circle\")\n        .attr(\"fill\", d => d.children ? color(d.depth) : \"white\")\n        .attr(\"pointer-events\", d => !d.children ? \"none\" : null)\n        .on(\"mouseover\", function() { d3.select(this).attr(\"stroke\", \"#000\"); })\n        .on(\"mouseout\", function() { d3.select(this).attr(\"stroke\", null); })\n        .on(\"click\", handleClick);\n  \n    const label = svg.append(\"g\")\n        .style(\"font\", \"10px sans-serif\")\n        .attr(\"pointer-events\", \"none\")\n        .attr(\"text-anchor\", \"middle\")\n      .selectAll(\"text\")\n      .data(root.descendants())\n      .join(\"text\")\n        .style(\"fill-opacity\", d => d.parent === root ? 1 : 0)\n        .style(\"display\", d => d.parent === root ? \"inline\" : \"none\")\n        .text(d => d.data.name);\n  \n    zoomTo([root.x, root.y, root.r * 2]);\n    function handleClick(event, d){\n        console.log(\"clicky!!!!\",event,d)\n        var ev = new CustomEvent('chartFilter', {detail:{'name':d.data.name,'depth': d.depth}});\n        window.dispatchEvent(ev)\n        return focus !== d && (zoom(event, d), event.stopPropagation())\n    }\n    function handleResetClick(event){\n        zoom(event, root)\n        var ev = new CustomEvent('chartFilter', {detail:{'name':'','depth': 0}});\n        window.dispatchEvent(ev)\n    }\n    function zoomTo(v) {\n      const k = width / v[2];\n  \n      view = v;\n  \n      label.attr(\"transform\", d => `translate(${(d.x - v[0]) * k},${(d.y - v[1]) * k})`);\n      node.attr(\"transform\", d => `translate(${(d.x - v[0]) * k},${(d.y - v[1]) * k})`);\n      node.attr(\"r\", d => d.r * k);\n    }\n  \n    function zoom(event, d) {\n      const focus0 = focus;\n  \n      focus = d;\n  \n      const transition = svg.transition()\n          .duration(event.altKey ? 7500 : 750)\n          .tween(\"zoom\", d => {\n            const i = d3.interpolateZoom(view, [focus.x, focus.y, focus.r * 2]);\n            return t => zoomTo(i(t));\n          });\n  \n      label\n        .filter(function(d) { return d.parent === focus || this.style.display === \"inline\"; })\n        .transition(transition)\n          .style(\"fill-opacity\", d => d.parent === focus ? 1 : 0)\n          .on(\"start\", function(d) { if (d.parent === focus) this.style.display = \"inline\"; })\n          .on(\"end\", function(d) { if (d.parent !== focus) this.style.display = \"none\"; });\n    }\n  \n    return svg.node();\n  }\n\n  function convertToCirclePack(data){\n      //find first numeric column\n      var outObj = []\n      for (var i=0;i<data.length;i++){\n        var row = data[i]\n\n        for (var j=1;j<row.length;j++){\n            outObj = addChild(outObj,row,0)\n        }\n      } \n      console.log(\"out obj\",outObj)\n      return outObj;\n  }\n\n function addChild(currentObj,row,iteration){\n\n    var idx = currentObj.findIndex(x => x.name === row[iteration]);\n    if  (idx != -1 && currentObj[idx].children){\n        var nextObj = currentObj[idx].children\n        if (iteration==row.length){\n            currentObj[idx]['value'] = row[iteration]\n            return currentObj\n        }else{\n            currentObj[idx].children = addChild(nextObj,row,iteration+1)\n        }\n    }else{\n        if (iteration==row.length-2){\n            currentObj[currentObj.length] = { \n                'name': row[iteration],\n                'value': row[iteration+1]\n            }\n        }else{\n            currentObj[currentObj.length] = { \n                'name': row[iteration],\n                'children': addChild([],row,iteration+1)\n            }\n        }\n    }\n    return currentObj;\n  }"]},"metadata":{},"sourceType":"module"}